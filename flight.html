<script>
    // Auth Guard
    (function() {
        const auth = localStorage.getItem('nexus_auth');
        const session = sessionStorage.getItem('nexus_session');
        if(!auth && !session) {
            window.location.href = 'splash.html';
        }
    })();
</script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flights | Nexus</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/flight.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <a href="travel.html" class="back-btn">
            <i class="fas fa-arrow-left"></i>
        </a>
        <h1>Book Flight</h1>
        <button class="icon-btn" onclick="window.location.href='profile.html'">
            <i class="fas fa-user"></i>
        </button>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Trip Type Toggle -->
        <div class="trip-toggle">
            <label class="radio-label active">
                <input type="radio" name="tripType" value="oneway" checked onchange="setTripType(this)">
                <span>One Way</span>
            </label>
            <label class="radio-label">
                <input type="radio" name="tripType" value="roundtrip" onchange="setTripType(this)">
                <span>Round Trip</span>
            </label>
        </div>

        <!-- Search Form -->
        <div class="search-box">
            <!-- From -->
            <div class="field-group" onclick="openAirportPicker('from')">
                <label class="field-label">From</label>
                <div class="field-value" id="fromAirport">Select <span class="code">(---)</span></div>
            </div>

            <!-- Swap Button -->
            <button class="swap-btn" onclick="swapAirports()">
                <i class="fas fa-exchange-alt"></i>
            </button>

            <!-- To -->
            <div class="field-group" onclick="openAirportPicker('to')">
                <label class="field-label">To</label>
                <div class="field-value" id="toAirport">Select <span class="code">(---)</span></div>
            </div>

            <!-- Depart Date -->
            <div class="field-group date-field" onclick="openDatePicker()">
                <label class="field-label">Depart</label>
                <div class="field-value" id="departDate">Select Date</div>
            </div>

            <!-- Return Date -->
            <div class="field-group date-field return-field disabled" id="returnField" onclick="openDatePicker('return')">
                <label class="field-label">Return</label>
                <div class="field-value return-text" id="returnDate">Add Return</div>
            </div>

            <!-- Passengers & Class -->
            <div class="field-group full-width" onclick="openPassengerPicker()">
                <label class="field-label">Passenger & Class</label>
                <div class="field-value" id="passengerClass">1 Traveller, Economy <i class="fas fa-chevron-down"></i></div>
            </div>
        </div>

        <!-- Search Button -->
        <button class="search-btn" onclick="searchFlights()">
            Search Flights
        </button>
    </main>

    <!-- Airport Picker Modal -->
    <div id="airportModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="airportModalTitle">Select Origin</h3>
                <button class="close-btn" onclick="closeModal('airportModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="search-input">
                <i class="fas fa-search"></i>
                <input type="text" id="airportSearch" placeholder="Search city or airport code" oninput="filterAirports(this.value)">
            </div>
            <div class="search-status" id="searchStatus">Type to search 132 airports</div>
            <div class="city-list" id="airportList">
                <!-- Airports injected via JS -->
            </div>
        </div>
    </div>

    <!-- Date Picker Modal -->
    <div id="dateModal" class="modal hidden">
        <div class="modal-content date-modal">
            <div class="modal-header">
                <h3>Select Date</h3>
                <button class="close-btn" onclick="closeModal('dateModal')"><i class="fas fa-times"></i></button>
            </div>
            <div class="calendar" id="calendar">
                <!-- Calendar injected via JS -->
            </div>
        </div>
    </div>

    <!-- Passenger Picker Modal -->
    <div id="passengerModal" class="modal hidden">
        <div class="modal-content passenger-modal">
            <div class="modal-header">
                <h3>Passengers & Class</h3>
                <button class="close-btn" onclick="closeModal('passengerModal')"><i class="fas fa-times"></i></button>
            </div>
            
            <div class="passenger-section">
                <h4>Add Travellers</h4>
                <div class="counter-row">
                    <div>
                        <span class="counter-label">Adults</span>
                        <span class="counter-sub">12+ years</span>
                    </div>
                    <div class="counter">
                        <button onclick="updateCount('adults', -1)"><i class="fas fa-minus"></i></button>
                        <span id="adultsCount">1</span>
                        <button onclick="updateCount('adults', 1)"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
                <div class="counter-row">
                    <div>
                        <span class="counter-label">Children</span>
                        <span class="counter-sub">2-12 years</span>
                    </div>
                    <div class="counter">
                        <button onclick="updateCount('children', -1)"><i class="fas fa-minus"></i></button>
                        <span id="childrenCount">0</span>
                        <button onclick="updateCount('children', 1)"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
                <div class="counter-row">
                    <div>
                        <span class="counter-label">Infants</span>
                        <span class="counter-sub">0-2 years</span>
                    </div>
                    <div class="counter">
                        <button onclick="updateCount('infants', -1)"><i class="fas fa-minus"></i></button>
                        <span id="infantsCount">0</span>
                        <button onclick="updateCount('infants', 1)"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
            </div>

            <div class="class-section">
                <h4>Choose Class</h4>
                <label class="class-option">
                    <input type="radio" name="travelClass" value="economy" checked onchange="setClass(this)">
                    <span>Economy</span>
                </label>
                <label class="class-option">
                    <input type="radio" name="travelClass" value="premium" onchange="setClass(this)">
                    <span>Premium Economy</span>
                </label>
                <label class="class-option">
                    <input type="radio" name="travelClass" value="business" onchange="setClass(this)">
                    <span>Business</span>
                </label>
            </div>

            <button class="done-btn" onclick="applyPassengers()">Done</button>
        </div>
    </div>

    <script src="js/flight.js"></script>
</body>
</html>